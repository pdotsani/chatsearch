<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/5.8.1/github-markdown-light.min.css" integrity="sha512-X175XRJAO6PHAUi8AA7GP8uUF5Wiv+w9bOi64i02CHKDQBsO1yy0jLSKaUKg/NhRCDYBmOLQCfKaTaXiyZlLrw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <script src="https://unpkg.com/htmx.org@1.9.10"></script>
    <style>
        .message { 
            margin: 10px 0; 
            padding: 10px; 
            border-radius: 5px; 
        }
        .user-message { 
            background: #e3f2fd; 
            text-align: right; 
        }
        .bot-message { 
            background: #f5f5f5; 
        }

        .markdown-body {
            box-sizing: border-box;
            min-width: 200px;
            max-width: 980px;
            margin: 0 auto;
            padding: 45px;
        }

        @media (max-width: 767px) {
            .markdown-body {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <div id="chat-container">
        <div id="messages"></div>
        
        <form hx-post="/chat" 
              hx-target="#messages" 
              hx-swap="beforeend"
              hx-on::before-request="addUserMessage(event)">
            <input type="text" 
                   name="message" 
                   id="message-input"
                   placeholder="Type your message..."
                   required />
            <button type="submit">Send</button>
        </form>
    </div>
    
    <script>
        function addUserMessage(event) {
            const input = document.getElementById('message-input');
            const userMessage = input.value;
            
            // Add user message immediately
            const userDiv = document.createElement('div');
            userDiv.className = 'message user-message markdown-body';
            userDiv.innerHTML = `<strong>You:</strong> ${userMessage}`;
            document.getElementById('messages').appendChild(userDiv);
            
            // Clear input
            input.value = '';
        }
    </script>
</body>
</html>